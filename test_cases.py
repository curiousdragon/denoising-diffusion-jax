from utils import run_tests

# Importable functions

# run_diffusion_mean_tests
# run_diffusion_cov_tests

# run_mean_loss_tests
# run_noise_loss_tests


class DiffusionTestCases:
    x = [
        [
            0.42271078,
            0.10988367,
            0.17936432,
            0.55772698,
            0.50072408,
            0.22675169,
            0.21109331,
            0.54872036,
            0.43019009,
            0.85498917,
        ],
        [
            0.40325677,
            0.21874166,
            0.65812516,
            0.70358491,
            0.08702171,
            0.0146271,
            0.39282465,
            0.91398573,
            0.62171268,
            0.63578844,
        ],
        [
            0.35615385,
            0.60827816,
            0.88815582,
            0.38277769,
            0.03948212,
            0.94029844,
            0.2988342,
            0.55170822,
            0.09887683,
            0.08440983,
        ],
        [
            0.72040713,
            0.67677045,
            0.51662374,
            0.47618616,
            0.62078416,
            0.56535423,
            0.47907531,
            0.87854779,
            0.95741868,
            0.6435374,
        ],
        [
            0.17340672,
            0.45538437,
            0.7655853,
            0.81880558,
            0.16407394,
            0.37448525,
            0.07771182,
            0.45887375,
            0.1897943,
            0.34695685,
        ],
    ]
    var = [0.1, 0.2, 0.3, 0.4, 0.5]
    mean = [
        [
            0.40101865,
            0.1042448,
            0.17015994,
            0.52910626,
            0.47502854,
            0.21511553,
            0.20026068,
            0.52056181,
            0.40811414,
            0.81111389,
        ],
        [
            0.36068383,
            0.19564848,
            0.58864504,
            0.62930548,
            0.07783458,
            0.01308288,
            0.35135305,
            0.81749368,
            0.55607671,
            0.56866646,
        ],
        [
            0.29797968,
            0.50892204,
            0.74308449,
            0.3202548,
            0.03303311,
            0.78671014,
            0.25002262,
            0.46159223,
            0.08272628,
            0.07062233,
        ],
        [
            0.558025,
            0.52422416,
            0.40017503,
            0.36885223,
            0.48085737,
            0.43792152,
            0.37109014,
            0.68052024,
            0.74161333,
            0.49848193,
        ],
        [
            0.12261707,
            0.32200536,
            0.54135054,
            0.57898295,
            0.1160178,
            0.26480106,
            0.05495055,
            0.32447273,
            0.13420483,
            0.24533553,
        ],
    ]
    cov = [
        [
            [0.1, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0],
            [0.0, 0.1, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0],
            [0.0, 0.0, 0.1, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0],
            [0.0, 0.0, 0.0, 0.1, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0],
            [0.0, 0.0, 0.0, 0.0, 0.1, 0.0, 0.0, 0.0, 0.0, 0.0],
            [0.0, 0.0, 0.0, 0.0, 0.0, 0.1, 0.0, 0.0, 0.0, 0.0],
            [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.1, 0.0, 0.0, 0.0],
            [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.1, 0.0, 0.0],
            [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.1, 0.0],
            [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.1],
        ],
        [
            [0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0],
            [0.0, 0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0],
            [0.0, 0.0, 0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0],
            [0.0, 0.0, 0.0, 0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0],
            [0.0, 0.0, 0.0, 0.0, 0.2, 0.0, 0.0, 0.0, 0.0, 0.0],
            [0.0, 0.0, 0.0, 0.0, 0.0, 0.2, 0.0, 0.0, 0.0, 0.0],
            [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.2, 0.0, 0.0, 0.0],
            [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.2, 0.0, 0.0],
            [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.2, 0.0],
            [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.2],
        ],
        [
            [0.30000001, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0],
            [0.0, 0.30000001, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0],
            [0.0, 0.0, 0.30000001, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0],
            [0.0, 0.0, 0.0, 0.30000001, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0],
            [0.0, 0.0, 0.0, 0.0, 0.30000001, 0.0, 0.0, 0.0, 0.0, 0.0],
            [0.0, 0.0, 0.0, 0.0, 0.0, 0.30000001, 0.0, 0.0, 0.0, 0.0],
            [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.30000001, 0.0, 0.0, 0.0],
            [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.30000001, 0.0, 0.0],
            [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.30000001, 0.0],
            [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.30000001],
        ],
        [
            [0.40000001, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0],
            [0.0, 0.40000001, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0],
            [0.0, 0.0, 0.40000001, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0],
            [0.0, 0.0, 0.0, 0.40000001, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0],
            [0.0, 0.0, 0.0, 0.0, 0.40000001, 0.0, 0.0, 0.0, 0.0, 0.0],
            [0.0, 0.0, 0.0, 0.0, 0.0, 0.40000001, 0.0, 0.0, 0.0, 0.0],
            [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.40000001, 0.0, 0.0, 0.0],
            [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.40000001, 0.0, 0.0],
            [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.40000001, 0.0],
            [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.40000001],
        ],
        [
            [0.5, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0],
            [0.0, 0.5, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0],
            [0.0, 0.0, 0.5, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0],
            [0.0, 0.0, 0.0, 0.5, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0],
            [0.0, 0.0, 0.0, 0.0, 0.5, 0.0, 0.0, 0.0, 0.0, 0.0],
            [0.0, 0.0, 0.0, 0.0, 0.0, 0.5, 0.0, 0.0, 0.0, 0.0],
            [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.5, 0.0, 0.0, 0.0],
            [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.5, 0.0, 0.0],
            [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.5, 0.0],
            [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.5],
        ],
    ]
    tests = zip(x, var, mean, cov)


def run_diffusion_mean_tests(function):
    x = DiffusionTestCases.x
    var = DiffusionTestCases.var
    mean = DiffusionTestCases.mean
    run_tests(zip(x, var), mean, function, "Diffusion mean")


def run_diffusion_cov_tests(function):
    x = DiffusionTestCases.x
    var = DiffusionTestCases.var
    cov = DiffusionTestCases.cov
    run_tests(zip(x, var), cov, function, "Diffusion covariance")


class LossFunctionTestCases:
    sigma_ts = [
        0.6988890644043985,
        0.09701159310046781,
        0.0912221692307218,
        0.3365458259546885,
        0.41579043751424505,
        0.29242040021883275,
        0.2995829524325463,
        0.6438997790399706,
        0.5865661033705025,
        0.14913441778969017,
    ]

    alpha_tses = [
        [
            0.6698977275045601,
            0.29700361193674063,
            0.6269245625048834,
            0.9687589730754044,
            0.0996305568330842,
        ],
        [
            0.6237354568295896,
            0.8412528061972744,
            0.5364172819262529,
            0.42220126387347934,
            0.32548152951005527,
        ],
        [
            0.37333027178225797,
            0.4460096567412415,
            0.16939295592310477,
            0.9786744363283064,
            0.9384181702612944,
        ],
        [
            0.8086672953604127,
            0.5838672246391894,
            0.2080886096407517,
            0.3055491498815537,
            0.5177687988436884,
        ],
        [
            0.7705685073338451,
            0.33076556366529175,
            0.5669981653103964,
            0.4690047911008477,
            0.39738200222670583,
        ],
        [
            0.024556855575012415,
            0.40657817701742505,
            0.9394777526765903,
            0.19309552944004837,
            0.6224516000061981,
        ],
        [
            0.9134791396462295,
            0.2943177138658791,
            0.9145387514712104,
            0.6761085870931394,
            0.18425796977953268,
        ],
        [
            0.364493566749459,
            0.2991698118604834,
            0.5614297856216275,
            0.28789042369258466,
            0.014799429364788397,
        ],
        [
            0.10663804688776202,
            0.02568873903494251,
            0.49516981184223496,
            0.44912962227530817,
            0.8129549739341861,
        ],
        [
            0.2543387240452901,
            0.8323391800318249,
            0.5844746683388324,
            0.681554857902384,
            0.9357238256071887,
        ],
    ]

    mu_preds = [
        [
            0.9903870243739178,
            0.7069138268863461,
            0.18149816535252283,
            0.2905307035343777,
            0.6760029411543935,
        ],
        [
            0.16216062430197076,
            0.14789843706759853,
            0.38891819918157255,
            0.7724899734739576,
            0.3993702264006673,
        ],
        [
            0.4756558535594767,
            0.48417704483536483,
            0.3671434743318255,
            0.7995827885413929,
            0.26654083397993644,
        ],
        [
            0.690235071397402,
            0.9085184411915164,
            0.46319245346451576,
            0.5262745620145711,
            0.16675987345858723,
        ],
        [
            0.6131295692148473,
            0.5275782606753504,
            0.28720915582662077,
            0.20391422942222304,
            0.16197267238749624,
        ],
        [
            0.536121671139786,
            0.972849804201971,
            0.4121152597072386,
            0.6387591028878262,
            0.44423243492473086,
        ],
        [
            0.5462287563845036,
            0.8543642309618268,
            0.2618839807818444,
            0.5649971819641563,
            0.056922002708079567,
        ],
        [
            0.5694469321578538,
            0.42130913859487207,
            0.9448824401373882,
            0.16034791295913609,
            0.4514393100572379,
        ],
        [
            0.8430422184211609,
            0.19150607367033667,
            0.47052743756212234,
            0.9598832376453899,
            0.1993530450423162,
        ],
        [
            0.5596958559065373,
            0.7889270657196124,
            0.5341155414049908,
            0.9844540862074933,
            0.3972793124280779,
        ],
    ]

    eps_preds = [
        [
            0.7353947085322168,
            0.4091297620605414,
            0.631160791272258,
            0.9934583512587662,
            0.728311081840874,
        ],
        [
            0.5190191975338816,
            0.2733558570685628,
            0.37397952288547076,
            0.657320092931258,
            0.10270313670183784,
        ],
        [
            0.1806349203173523,
            0.39958357147989265,
            0.6815289883958849,
            0.26078232039089333,
            0.47015431926332885,
        ],
        [
            0.7828451833545705,
            0.7302913288292918,
            0.9421519905600212,
            0.7872911683350303,
            0.27201812338858833,
        ],
        [
            0.08938321952099448,
            0.10505224412486214,
            0.012889816711021962,
            0.2654203459077421,
            0.2958406819137196,
        ],
        [
            0.7171891625701999,
            0.9118761693616572,
            0.9460666868802617,
            0.008372627390768494,
            0.09210526146320253,
        ],
        [
            0.7544639344127367,
            0.31419315331457454,
            0.4983367875598905,
            0.9062664045586968,
            0.5398347254761521,
        ],
        [
            0.1581650976833333,
            0.6068991378512455,
            0.6133364204266607,
            0.8218357783533815,
            0.5805600636010225,
        ],
        [
            0.6112689976909634,
            0.7514684133286195,
            0.32352229545205713,
            0.10569677665886068,
            0.4685673415911178,
        ],
        [
            0.49555986895554605,
            0.9052047977946474,
            0.9476511491010715,
            0.6618549140838094,
            0.8188650216515843,
        ],
    ]

    epses = [
        [
            0.9671885663560873,
            0.2996325157331209,
            0.564254382850026,
            0.5995563616143008,
            0.7890691132866064,
        ],
        [
            0.8331733277878522,
            0.9584829277385266,
            0.8376307742343067,
            0.610375618348631,
            0.5367577699653943,
        ],
        [
            0.19169708349054315,
            0.378581738364392,
            0.4307591120018065,
            0.43495098777505936,
            0.7855646061826317,
        ],
        [
            0.44885787658589404,
            0.7361491358809114,
            0.5425831790175984,
            0.033622313178850005,
            0.9426907598049958,
        ],
        [
            0.6435867751244722,
            0.23074970173318032,
            0.7751003146242845,
            0.7010727000908218,
            0.24167380035743713,
        ],
        [
            0.04842571047738997,
            0.7649861738405602,
            0.1273567587576021,
            0.4160855678294446,
            0.34338190128025214,
        ],
        [
            0.09501481822052349,
            0.862710830122278,
            0.20366232399010387,
            0.053715833210152164,
            0.7757800005232579,
        ],
        [
            0.6880299282182443,
            0.894120042553381,
            0.7979984480744026,
            0.08088145288314819,
            0.027808530235225115,
        ],
        [
            0.8402998004214409,
            0.561339926431487,
            0.1667643142399836,
            0.39271648806805404,
            0.0425701180704795,
        ],
        [
            0.5902704623867533,
            0.534004131843172,
            0.5061264353295981,
            0.14448837337908793,
            0.6739615233239407,
        ],
    ]

    x_0s = [
        [
            0.7416128195110062,
            0.7162944436959404,
            0.4623529115449023,
            0.12450551021268985,
            0.623677850915316,
        ],
        [
            0.9070198519901664,
            0.26020152582143574,
            0.004302153368657691,
            0.2652581917645501,
            0.5173573481220373,
        ],
        [
            0.35888506224095207,
            0.24659199234478268,
            0.41307547615470763,
            0.09966208909459062,
            0.7404793570961178,
        ],
        [
            0.20075228990277094,
            0.5023816093888114,
            0.41058972354114254,
            0.7309135642451283,
            0.3308289002440279,
        ],
        [
            0.14029486502972432,
            0.2347875560891136,
            0.07284387112042712,
            0.2929984301714261,
            0.356609317089127,
        ],
        [
            0.926181999843466,
            0.03260398520004837,
            0.49743038562407693,
            0.3707703083823888,
            0.30814363625756913,
        ],
        [
            0.0444866743517911,
            0.36229102767292887,
            0.8796888072563296,
            0.836008323413254,
            0.42988956332852246,
        ],
        [
            0.9829564035183326,
            0.5242793211086514,
            0.3726450748514353,
            0.43562951561592045,
            0.7396655375999965,
        ],
        [
            0.30079294524027034,
            0.2369108547710559,
            0.3362940873808131,
            0.06371880653436435,
            0.4858606217918705,
        ],
        [
            0.19865823926690274,
            0.6848697431044621,
            0.09117787375209607,
            0.822596469038247,
            0.6848690044885717,
        ],
    ]

    x_ts = [
        [
            0.37418830877381637,
            0.7338212690084154,
            0.9280362214383209,
            0.1670122354505248,
            0.24413001418454783,
        ],
        [
            0.38148963359724064,
            0.8100585149033076,
            0.32588609374629596,
            0.783623152583346,
            0.6884474976436902,
        ],
        [
            0.6760130290168371,
            0.6551422091561949,
            0.8156265373167101,
            0.12690134264046815,
            0.2568119352876278,
        ],
        [
            0.517735111756319,
            0.818956784376035,
            0.8247733485322224,
            0.7943912174548602,
            0.4567634177613924,
        ],
        [
            0.5789545896762142,
            0.31222111207138303,
            0.825504620192041,
            0.6003226897378626,
            0.7006923187054598,
        ],
        [
            0.09381874081281671,
            0.2438698435862814,
            0.00896158052874163,
            0.5961303504794011,
            0.7040280164320747,
        ],
        [
            0.1062156245182132,
            0.010646796459048757,
            0.40485398277726525,
            0.9873698002646776,
            0.24998649122904604,
        ],
        [
            0.4727775097646646,
            0.09045505737915316,
            0.4765888045105777,
            0.1673834620448288,
            0.7408180227171042,
        ],
        [
            0.13728578414932846,
            0.2606350217085063,
            0.769055143619136,
            0.895807636545625,
            0.81024376377571,
        ],
        [
            0.12427302514364436,
            0.4601245101998429,
            0.710426821595351,
            0.7720441391201761,
            0.9900525907620296,
        ],
    ]

    mean_vals = [
        0.7764778733253479,
        17.232927322387695,
        41.724002838134766,
        1.0754915475845337,
        0.9903479218482971,
        5.882837295532227,
        4.712336540222168,
        1.262110710144043,
        1.2719426155090332,
        15.68697452545166,
    ]

    noise_vals = [
        1.9310036897659302,
        75.2190933227539,
        0.04817648231983185,
        2.5961599349975586,
        2.9786267280578613,
        1.834517002105713,
        33.313907623291016,
        99.04232025146484,
        0.023591423407197,
        0.06792958080768585,
    ]


def run_mean_loss_tests(function):
    sigma_ts = LossFunctionTestCases.sigma_ts
    alpha_tses = LossFunctionTestCases.alpha_tses
    mu_preds = LossFunctionTestCases.mu_preds
    x_0s = LossFunctionTestCases.x_0s
    x_ts = LossFunctionTestCases.x_ts
    mean_vals = LossFunctionTestCases.mean_vals
    run_tests(
        zip(sigma_ts, alpha_tses, mu_preds, x_0s, x_ts),
        mean_vals,
        function,
        "Mean loss",
    )


def run_noise_loss_tests(function):
    sigma_ts = LossFunctionTestCases.sigma_ts
    alpha_tses = LossFunctionTestCases.alpha_tses
    eps_preds = LossFunctionTestCases.eps_preds
    x_0s = LossFunctionTestCases.x_0s
    x_ts = LossFunctionTestCases.x_ts
    epses = LossFunctionTestCases.epses
    noise_vals = LossFunctionTestCases.noise_vals
    run_tests(
        zip(sigma_ts, alpha_tses, eps_preds, x_0s, x_ts, epses),
        noise_vals,
        function,
        "Noise loss",
    )
